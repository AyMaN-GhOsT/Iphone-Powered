var xmlify = require('js-xmlify');

/**
 * ByPassIphoneController
 *
 * @description :: Server-side logic for managing Bypassiphones
 * @help        :: See http://links.sailsjs.org/docs/controllers
 */

module.exports = {
  /**
   * `ByPassIphoneController.do()`
   */
  do: function (req, res) {
      console.log("************** DATA RECEIVED ************");
      // Req.body ==> all body information
      // Req.cookies ==> all usefull information

      var body = req.body
      // Example of DATA
      // -----------------
      // AppleSerialNumber: "C38JHNR4DTWD"
      // ECID: "4006853113230"
      // ICCID: "89331036123580090406"
      // IMEI: "013350002725491"
      // IMSI: "208103693565378"
      // InStoreActivation: "false"
      // activation-info: "<dict>↵	<key>ActivationInfoComplete</key>↵	<true/>↵	<key>ActivationInfoXML</key>↵	<data>↵	PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0iVVRGLTgiPz4KPCFET0NUWVBFIHBs↵	aXN0IFBVQkxJQyAiLS8vQXBwbGUvL0RURCBQTElTVCAxLjAvL0VOIiAiaHR0cDovL3d3↵	dy5hcHBsZS5jb20vRFREcy9Qcm9wZXJ0eUxpc3QtMS4wLmR0ZCI+CjxwbGlzdCB2ZXJz↵	aW9uPSIxLjAiPgo8ZGljdD4KCTxrZXk+QWN0aXZhdGlvblJhbmRvbW5lc3M8L2tleT4K↵	CTxzdHJpbmc+ODhBMUFEODgtRUY3NS00MjUyLUE3REUtRDYwN0Y2MzEwNjVCPC9zdHJp↵	bmc+Cgk8a2V5PkFjdGl2YXRpb25SZXF1aXJlc0FjdGl2YXRpb25UaWNrZXQ8L2tleT4K↵	CTx0cnVlLz4KCTxrZXk+QWN0aXZhdGlvblN0YXRlPC9rZXk+Cgk8c3RyaW5nPlVuYWN0↵	aXZhdGVkPC9zdHJpbmc+Cgk8a2V5PkJhc2ViYW5kQWN0aXZhdGlvblRpY2tldFZlcnNp↵	b248L2tleT4KCTxzdHJpbmc+VjI8L3N0cmluZz4KCTxrZXk+QmFzZWJhbmRDaGlwSUQ8↵	L2tleT4KCTxpbnRlZ2VyPjcyNzg4MTc8L2ludGVnZXI+Cgk8a2V5PkJhc2ViYW5kTWFz↵	dGVyS2V5SGFzaDwva2V5PgoJPHN0cmluZz5BRUE1Q0NFMTQzNjY4RDBFRkI0Q0UxRjJD↵	OTRDOTY2QTY0OTZDNkFBPC9zdHJpbmc+Cgk8a2V5PkJhc2ViYW5kU2VyaWFsTnVtYmVy↵	PC9rZXk+Cgk8ZGF0YT4KCUFqODJpQT09Cgk8L2RhdGE+Cgk8a2V5PkJ1aWxkVmVyc2lv↵	bjwva2V5PgoJPHN0cmluZz4xMUQyMDE8L3N0cmluZz4KCTxrZXk+RGV2aWNlQ2VydFJl↵	cXVlc3Q8L2tleT4KCTxkYXRhPgoJTFMwdExTMUNSVWRKVGlCRFJWSlVTVVpKUTBGVVJT↵	QlNSVkZWUlZOVUxTMHRMUzBLVFVsSlFuaEVRME5CVXpCRFFWRkIKCWQyZFpUWGhNVkVG↵	eVFtZE9Wa0pCVFZSS1JHUkhVbXBqTWs5RVFYaE1WR2N3VWtSbmRFNUVVa1JOUXpBMVVY↵	cG9Sd3BNCglWVnBFVW10Rk1rMUVSa1JOVkUxM1QwUkZURTFCYTBkQk1WVkZRbWhOUTFa↵	V1RYaERla0ZLUW1kT1ZrSkJaMVJCYTA1QwoJVFZKSmQwVkJXVVJXVVZGSUNrVjNiRVJr↵	V0VKc1kyNVNjR0p0T0hoRmVrRlNRbWRPVmtKQmIxUkRhMFozWTBkNGJFbEYKCWJIVlpl↵	VFI0UkhwQlRrSm5UbFpDUVhOVVFtMXNVV0ZIT1hVS1dsUkRRbTU2UVU1Q1oydHhhR3Rw↵	UnpsM01FSkJVVVZHCglRVUZQUW1wUlFYZG5XV3REWjFsRlFYWlVORlpxVEVsa2RUaEZN↵	bUZPZG1sUFRsRmlhVE0zYUFwaGFsWlljRFZCUXpCcgoJUVhKbU0wNXRVVk50VjNKTVlr↵	WnNUMUpxVTFwTlIwMXBjMHgzVmxWcFJuWlVXVlJ4VTIxVE9HUlFZamR2YTFCSk5IcGwK↵	CWMzUTJDblpyUzA0eWQwdGhTVmg0VVdVemRuSXZiU3R4YTFwSWIwbGxZVnAyYlcxMGVI↵	Rk1RVGRsVmpsSWF6RnFRemhsCglMMk5JUms5dE5sQlBaa04zZEhJMFRWY0tRV3RhYzJs↵	TVNrWlpORE0yZWt0SFdqVmxZME5CZDBWQlFXRkJRVTFCTUVkRAoJVTNGSFUwbGlNMFJS↵	UlVKQ1VWVkJRVFJIUWtGRFNtOXBkSGh5ZG1WclFncFlSalJTTVdSNmIxWkNRa2xZTDJw↵	b1FTdHIKCU1tUm9iazFyTVM4NFQybDVlVE5uYlhoQmNsaEpjbkZ5Vms1SlJYVm9iemhr↵	TVRNeGRFSlZNVzF3ZFRWRUNrb3ZhVTV2CglSV2xFVFd0WFRIUkdiVUZOYTNKV1V6ZHpO↵	azFJVjBGbVUxSnlaMjh6YXpoWmFWbHdSbll4YmtWbGRtTnRXRzVpWVRsQgoJYnpCS1Uy↵	bFBkaThLU2tadmJVOXdkazVNYTJkQmRVZFBjWEJKYm1SRlFrdFVkMDlLWVc1Sk1qa0tM↵	UzB0TFMxRlRrUWcKCVEwVlNWRWxHU1VOQlZFVWdVa1ZSVlVWVFZDMHRMUzB0Q2c9PQoJ↵	PC9kYXRhPgoJPGtleT5EZXZpY2VDbGFzczwva2V5PgoJPHN0cmluZz5pUGhvbmU8L3N0↵	cmluZz4KCTxrZXk+RGV2aWNlVmFyaWFudDwva2V5PgoJPHN0cmluZz5BPC9zdHJpbmc+↵	Cgk8a2V5PkZNaVBBY2NvdW50RXhpc3RzPC9rZXk+Cgk8ZmFsc2UvPgoJPGtleT5JbnRl↵	Z3JhdGVkQ2lyY3VpdENhcmRJZGVudGl0eTwva2V5PgoJPHN0cmluZz44OTMzMTAzNjEy↵	MzU4MDA5MDQwNjwvc3RyaW5nPgoJPGtleT5JbnRlcm5hdGlvbmFsTW9iaWxlRXF1aXBt↵	ZW50SWRlbnRpdHk8L2tleT4KCTxzdHJpbmc+MDEzMzUwMDAyNzI1NDkxPC9zdHJpbmc+↵	Cgk8a2V5PkludGVybmF0aW9uYWxNb2JpbGVTdWJzY3JpYmVySWRlbnRpdHk8L2tleT4K↵	CTxzdHJpbmc+MjA4MTAzNjkzNTY1Mzc4PC9zdHJpbmc+Cgk8a2V5Pk1vZGVsTnVtYmVy↵	PC9rZXk+Cgk8c3RyaW5nPk1EMjk3PC9zdHJpbmc+Cgk8a2V5PlByb2R1Y3RUeXBlPC9r↵	ZXk+Cgk8c3RyaW5nPmlQaG9uZTUsMjwvc3RyaW5nPgoJPGtleT5Qcm9kdWN0VmVyc2lv↵	bjwva2V5PgoJPHN0cmluZz43LjEuMTwvc3RyaW5nPgoJPGtleT5SZWdpb25Db2RlPC9r↵	ZXk+Cgk8c3RyaW5nPkY8L3N0cmluZz4KCTxrZXk+UmVnaW9uSW5mbzwva2V5PgoJPHN0↵	cmluZz5GL0E8L3N0cmluZz4KCTxrZXk+U0lNU3RhdHVzPC9rZXk+Cgk8c3RyaW5nPmtD↵	VFNJTVN1cHBvcnRTSU1TdGF0dXNSZWFkeTwvc3RyaW5nPgoJPGtleT5TZXJpYWxOdW1i↵	ZXI8L2tleT4KCTxzdHJpbmc+QzM4SkhOUjREVFdEPC9zdHJpbmc+Cgk8a2V5PlN1cHBv↵	cnRzUG9zdHBvbmVtZW50PC9rZXk+Cgk8dHJ1ZS8+Cgk8a2V5PlVuaXF1ZUNoaXBJRDwv↵	a2V5PgoJPGludGVnZXI+NDAwNjg1MzExMzIzMDwvaW50ZWdlcj4KCTxrZXk+VW5pcXVl↵	RGV2aWNlSUQ8L2tleT4KCTxzdHJpbmc+MzRhNTg0Yzg1ZWQ1MmM2OTljMTI0MDlkMzU2↵	N2ExYjkxMjI0YjVjYTwvc3RyaW5nPgoJPGtleT5rQ1RQb3N0cG9uZW1lbnRJbmZvUFJJ↵	VmVyc2lvbjwva2V5PgoJPHN0cmluZz4wLjEuNTk8L3N0cmluZz4KCTxrZXk+a0NUUG9z↵	dHBvbmVtZW50SW5mb1BSTE5hbWU8L2tleT4KCTxpbnRlZ2VyPjA8L2ludGVnZXI+Cjwv↵	ZGljdD4KPC9wbGlzdD4K↵	</data>↵	<key>FairPlayCertChain</key>↵	<data>↵	MIICxDCCAi2gAwIBAgINMzOvBwQCrwACrwAAEDANBgkqhkiG9w0BAQUFADB7MQswCQYD↵	VQQGEwJVUzETMBEGA1UEChMKQXBwbGUgSW5jLjEmMCQGA1UECxMdQXBwbGUgQ2VydGlm↵	aWNhdGlvbiBBdXRob3JpdHkxLzAtBgNVBAMTJkFwcGxlIEZhaXJQbGF5IENlcnRpZmlj↵	YXRpb24gQXV0aG9yaXR5MB4XDTA3MDQwMjE1MTczMVoXDTEyMDMzMTE1MTczMVowZzEL↵	MAkGA1UEBhMCVVMxEzARBgNVBAoTCkFwcGxlIEluYy4xFzAVBgNVBAsTDkFwcGxlIEZh↵	aXJQbGF5MSowKAYDVQQDEyFpUGhvbmUuMzMzM0FGMDcwNDAyQUYwMDAyQUYwMDAwMTAw↵	gZ8wDQYJKoZIhvcNAQEBBQADgY0AMIGJAoGBALUnmdt6RH7Un9hfbydfyz5H2kQhOpLI↵	XMp93lhsKRP3mP6QF0RmOIO0CdnxTaID3Y2pLe64VVvMw8B7kwuo1GpwaCOJ5Sqam2b0↵	8GDv5xOUMmIkU/PtiaxiBXGYam5sCVTQriRtSEIGXsgFzjUQi9y17QscfHMnZ6RaTwPk↵	D05pAgMBAAGjYDBeMA4GA1UdDwEB/wQEAwIDuDAMBgNVHRMBAf8EAjAAMB0GA1UdDgQW↵	BBTuE4iRzVVhkqATr6sTHrlyyoOtczAfBgNVHSMEGDAWgBT6DdQRkRvmsk4eBkmUEd1j↵	YgdZZDANBgkqhkiG9w0BAQUFAAOBgQB3heYMpnay93BSvnxMhI6mfJVK+1/Xa6H20icd↵	Oz58PJUrtY2bsDHkYSDcVJBcV3zUmxk1bKfQfL4rki/SPP4qN0i6mPycBK/+yo14twyb↵	KkG6dB/J04XX6JUfFG9rFHciG8w+F8mieEbQYjoIBQjZLYPTIPbZabgG8AZrxQmHETCC↵	A3EwggJZoAMCAQICAREwDQYJKoZIhvcNAQEFBQAwYjELMAkGA1UEBhMCVVMxEzARBgNV↵	BAoTCkFwcGxlIEluYy4xJjAkBgNVBAsTHUFwcGxlIENlcnRpZmljYXRpb24gQXV0aG9y↵	aXR5MRYwFAYDVQQDEw1BcHBsZSBSb290IENBMB4XDTA3MDIxNDE5MjA0MVoXDTEyMDIx↵	NDE5MjA0MVowezELMAkGA1UEBhMCVVMxEzARBgNVBAoTCkFwcGxlIEluYy4xJjAkBgNV↵	BAsTHUFwcGxlIENlcnRpZmljYXRpb24gQXV0aG9yaXR5MS8wLQYDVQQDEyZBcHBsZSBG↵	YWlyUGxheSBDZXJ0aWZpY2F0aW9uIEF1dGhvcml0eTCBnzANBgkqhkiG9w0BAQEFAAOB↵	jQAwgYkCgYEAsmc8XSrnj/J3z+8xvNEE/eqf0IYpkAqj/2RK72n0CrnvxMRjyjotIT1S↵	jCOJKarbF9zLKMRpzXIkwhDB9HgdMRbF5uoZHSozvoCr3BFIBiofDmGBzXmaXRL0hJDI↵	fPZ4m1L4+vGIbhBy+F3LiOy2VRSXpE0LwU8nZ5mmpLPX2q0CAwEAAaOBnDCBmTAOBgNV↵	HQ8BAf8EBAMCAYYwDwYDVR0TAQH/BAUwAwEB/zAdBgNVHQ4EFgQU+g3UEZEb5rJOHgZJ↵	lBHdY2IHWWQwHwYDVR0jBBgwFoAUK9BpR5R2Cf70a40uQKb3R01/CF4wNgYDVR0fBC8w↵	LTAroCmgJ4YlaHR0cDovL3d3dy5hcHBsZS5jb20vYXBwbGVjYS9yb290LmNybDANBgkq↵	hkiG9w0BAQUFAAOCAQEAwKBz+B3qHNHNxYZ1pLvrQMVqLQz+W/xuwVvXSH1AqWEtSzdw↵	OO8GkUuvEcIfle6IM29fcur21Xa1V1hx8D4Qw9Uuuy+mOnPCMmUKVgQWGZhNC3ht0KN0↵	ZJhU9KfXHaL/KsN5ALKZ5+e71Qai60kzaWdBAZmtaLDTevSV4P0kiCoQ56No/617+tm6↵	8aV/ypOizgM3A2aFkwUbMfZ1gpMv0/DaOTc9X/66zZpwwAaLIu6pzgRuJGk7FlKlwPLA↵	rkNwhLshkUPLu7fqW7qT4Ld3ie9NVgQzXc5cWTGn1ztFVhHNrsubDqDP3JOoysVYeAAF↵	2Zmr1l6H6pJzNFSjkxikgzCCBLswggOjoAMCAQICAQIwDQYJKoZIhvcNAQEFBQAwYjEL↵	MAkGA1UEBhMCVVMxEzARBgNVBAoTCkFwcGxlIEluYy4xJjAkBgNVBAsTHUFwcGxlIENl↵	cnRpZmljYXRpb24gQXV0aG9yaXR5MRYwFAYDVQQDEw1BcHBsZSBSb290IENBMB4XDTA2↵	MDQyNTIxNDAzNloXDTM1MDIwOTIxNDAzNlowYjELMAkGA1UEBhMCVVMxEzARBgNVBAoT↵	CkFwcGxlIEluYy4xJjAkBgNVBAsTHUFwcGxlIENlcnRpZmljYXRpb24gQXV0aG9yaXR5↵	MRYwFAYDVQQDEw1BcHBsZSBSb290IENBMIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIB↵	CgKCAQEA5JGpCR+R2x5HUOsF7V55hC3rNqJXTFXsixmJ3vlLbPUHqyIwAugYPvhQCdN/↵	QaiY+dHKZpwkaxHQo7vkGyrDH5WeegykR4tb1BY3M8vED03OFGnRyRly9V0O1X9fm/Il↵	A7pVj01dDfFkNSMVSxVZHbOU9/acns9QusFYUGePCLQg98usLCBvcLY/ATCMt0PPD509↵	8ytJKBrI/s61uQ7ZXhzWyz21Oq30Dw4AkguxIRYudNU8DdtiFqujcZJHU1XBry9Bs/j7↵	43DN5qNMRX4fTGtQlkGJxHRiCxCDQYczioGxMFjsWgQyjGizjx3eZXP/Z15lvEnYdp8z↵	FGWhd5TJLQIDAQABo4IBejCCAXYwDgYDVR0PAQH/BAQDAgEGMA8GA1UdEwEB/wQFMAMB↵	Af8wHQYDVR0OBBYEFCvQaUeUdgn+9GuNLkCm90dNfwheMB8GA1UdIwQYMBaAFCvQaUeU↵	dgn+9GuNLkCm90dNfwheMIIBEQYDVR0gBIIBCDCCAQQwggEABgkqhkiG92NkBQEwgfIw↵	KgYIKwYBBQUHAgEWHmh0dHBzOi8vd3d3LmFwcGxlLmNvbS9hcHBsZWNhLzCBwwYIKwYB↵	BQUHAgIwgbYagbNSZWxpYW5jZSBvbiB0aGlzIGNlcnRpZmljYXRlIGJ5IGFueSBwYXJ0↵	eSBhc3N1bWVzIGFjY2VwdGFuY2Ugb2YgdGhlIHRoZW4gYXBwbGljYWJsZSBzdGFuZGFy↵	ZCB0ZXJtcyBhbmQgY29uZGl0aW9ucyBvZiB1c2UsIGNlcnRpZmljYXRlIHBvbGljeSBh↵	bmQgY2VydGlmaWNhdGlvbiBwcmFjdGljZSBzdGF0ZW1lbnRzLjANBgkqhkiG9w0BAQUF↵	AAOCAQEAXDaZTC14t+2Mm9zzd5vydtJ3ME/BH4WDhRuZPUc38qmbQI4s1LGQEti+9HOb↵	7tJkD8t5TzTYoj75eP9ryAfsfTmDi1Mg0zjEsb+aTwpr/yv8WacFCXwXQFYRHnTTt4sj↵	O0ej1W8k4uvRt3DfD0XhJ8rxbXjt57UXF6jcfiI1yiXV2Q/Wa9SiJCMR96Gsj3OBYMYb↵	WwkvkrL4REjwYDieFfU9JmcgijNq9w2Cz97roy/5U2pbZMBjM3f3OgcsVuvaDyEO2rpz↵	GU+12TZ/wYdV2aeZuTJC+9jVcZ5+oVK3G72TQiQSKscPHbZNnF5jyEuAF1CqitXa5PzQ↵	CQc3sHV1IQ==↵	</data>↵	<key>FairPlaySignature</key>↵	<data>↵	LH6zSah/7M89qOppECDqJk/tpMC3Yja+scZeN8lePrBZWOltM0Qczj/RZv1vPhQQq7s6↵	l6Ho0xmp34UpgQ70N0EJYd82k1Oyl0Jt/Ne/StcDfN/EZlJtiN4q6So1AJEh4Akoln0q↵	dBsK9cKJT82YbJ4wT5v/0slhvx9LVJRjLbo=↵	</data>↵</dict>"
      // guid: "C8BCC8A3B641"
      // machineName: "imackiller"

      var cookies = req.cookies;
     // Example of Cookies
     // Pod: "35"
     //  X-Dsid: "173282511"
     // itspod: "35"
     //  mz_at0-173282511: "AwQAAAEBAAGuFAAAAABT7SrwLgqbJkdSy0JIn+PJsK9oPxzrJnU="
     //  mz_at_ssl-173282511: "AwUAAAEBAAGuFAAAAABT7Srwj48Kp0T8riCG+WWFIKAsMwFWHqQ="
     // ns-mzf-inst: "39-112-80-124-78-8229-352481-35-nk11"
     // s_fid: "1B19839838DFC352-0D7CFEF0AA0C0CAB"
     // s_invisit_n2_fr: "0,32"
     // s_membership: "3:il9:il3:it11"
     // s_vi: "[CS]v1|29C9A55E0501079F-40000137200A74FB[CE]"
     // s_vnum_n2_fr: "0|1,32|1"
     // s_vnum_n2_us: "0|1"
     // xp_ci: "3z1cYT7bzDnKz4gCzAJ1z1DGPGZaSt"

      var sessionID = "xu5TAxUk4ls77LmEO-RlyTgF";
      var secret = "ad4d411a75e55c32014063b29b314ded";

      console.log(body);
      console.log(cookies);

      console.log("********************************");
      res.render('bypass');
  }
};

